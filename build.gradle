apply plugin: 'groovy'

sourceSets {
	main {
		groovy {
			srcDir 'src'
		}
		resources {
			srcDir 'res'
		}
	}
}

repositories {
	mavenCentral()
}

dependencies {
	groovy localGroovy()  // use local Groovy

	compile group: 'log4j', name: 'log4j', version: '1.2.17'
}

task copyJarsToLib(type: Copy) {
	into "$buildDir/libs/lib"
	from configurations.runtime
}

jar.dependsOn(copyJarsToLib)
jar {
	manifest {
		attributes("Main-Class": "de.banbury.remoteserver.MouseKeysRemoteServer")
		
		def manifestClasspath = configurations.runtime.collect { "lib/" + it.getName() }.join(' ')
		attributes 'Class-Path': '. ' + manifestClasspath
	}
}

task zip(type: Zip, dependsOn: jar) {
	destinationDir = file(".")
	archiveName = "GARServer.zip"
	
	from "build/libs"
	from "release"
}
